Update magical cursor and code organization